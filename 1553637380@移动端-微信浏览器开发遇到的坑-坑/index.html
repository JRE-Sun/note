
<!DOCTYPE html>
<html>
  <!-- OriginalSrc: https://blog.csdn.net/m0_37036014/article/details/81232648 -->
  <head>
    <meta http-equiv="Content-Type" content="text/html"; charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>移动端 / 微信浏览器开发遇到的坑-坑</title>
    
<link rel="stylesheet" href="assets/1553637380-f166e036166639f07b8f8476f2dbb3df.css">

<link rel="stylesheet" href="assets/1553637380-7054c9a7bf20e7a4762de89feb3928a5.css">

<link rel="stylesheet" href="assets/1553637380-3ee558b18d32cf19bc5f15c8f3dc942f.css">

<link rel="stylesheet" type="text/css" href="assets/1553637380-287aed634bc19f202db333bc0533e7da.css">

<link rel="stylesheet" href="assets/1553637380-f5d764629eb4ab8e3132c472f1fe7f49.css">

<link rel="stylesheet" href="assets/1553637380-8afce11d00f7bc88a8191ad66e945525.css">

<link href="assets/1553637380-47e7ddc9e1c45ba790d4476fa588d265.css" rel="stylesheet">

<link rel="stylesheet" href="assets/1553637380-d59c8fbcb4e99f490e1b848904625eb0.css">

<link rel="stylesheet" href="assets/1553637380-5e49103610a4507dfceec6a81e7ab40f.css">

<link rel="stylesheet" href="assets/1553637380-186b0d2f06ccc88e64f41fdb5cf32ed8.css">

<link href="assets/1553637380-707064ce5456264570e22d85da458e5e.css" rel="stylesheet">

<link rel="stylesheet" type="text/css" href="assets/1553637380-ce2a7a7a13b3b2aae540a44424b01c4b.css">

<link rel="stylesheet" href="assets/1553637380-c4c55e51486fcfc5280a30bbe60ee721.css">
<style>
.login-box{position: fixed;display: none;left: 50%;top: 50%;z-index: 10000;-webkit-transform: translate(-50%, -50%);-ms-transform: translate(-50%, -50%);-o-transform: translate(-50%, -50%);-moz-transform: translate(-50%, -50%);transform: translate(-50%, -50%);background-color: #fff;}.login-mark{position: fixed;top: 0;left: 0;z-index: 9999;background-color: rgba(0, 0, 0, 0.5);width: 100%;height: 100%;display: none;}
</style>
<style>

html.cye-enabled.cye-nm:not(*:-webkit-full-screen) body,
 html.cye-enabled.cye-nm:not(*:-webkit-full-screen) #cye-workaround-body {-webkit-filter:contrast(91%) brightness(84%) invert(1);}
</style>
<style>
html.cye-enabled.cye-lm body{background-color:#cce8cf !important;border-color:rgb(51, 58, 51) !important;background-image:none !important;color:#000000  !important}
</style>
<style>
html.cye-enabled.cye-lm div{background-color:#cce8cf !important;border-color:rgb(51, 58, 51) !important;background-image:none !important;color:#000000  !important}
</style>
<style>
html.cye-enabled.cye-lm th{background-color:#cce8cf !important;border-color:rgb(51, 58, 51) !important;background-image:none !important;color:#000000  !important}html.cye-enabled.cye-lm td{background-color:#cce8cf !important;border-color:rgb(51, 58, 51) !important;background-image:none !important;color:#000000  !important}
</style>
<style>
html.cye-enabled.cye-lm input[type=text]{background-color:#cce8cf !important;border-color:rgb(51, 58, 51) !important;background-image:none !important;color:#000000  !important}html.cye-enabled.cye-lm textarea{background-color:#cce8cf !important;border-color:rgb(51, 58, 51) !important;background-image:none !important;color:#000000  !important}
</style>
<style>
html.cye-enabled.cye-lm select{background-color:#cce8cf !important;border-color:rgb(51, 58, 51) !important;background-image:none !important;color:#000000  !important}
</style>
<style>
html.cye-enabled.cye-lm ul{background-color:#cce8cf !important;border-color:rgb(51, 58, 51) !important;background-image:none !important;color:#000000  !important}
</style>
<style>
html.cye-enabled.cye-lm .cye-lm-tag,html.cye-enabled.cye-lm.cye-lm-tag{background-color:#cce8cf !important;border-color:rgb(51, 58, 51) !important;background-image:none !important;color:#000000  !important}
</style>
<style>

</style>
<style>

        .MathJax, .MathJax_Message, .MathJax_Preview{
            display: none
        }
    
</style>
<style>
.recommend-box ._4paradigm_box.T3 a .content-box{margin-left:0} .recommend-box ._4paradigm_box.T3 a .content-box h4{vertical-align:top}.recommend-box ._4paradigm_box.p4courset3_target {padding:0}.recommend-box ._4paradigm_box._paradigm_T_ads_render {padding:0} .recommend-box ._4paradigm_box._paradigm_T_ads_render a {width:100%;display:inline-block} ._4paradigm_box._paradigm_T_ads_render a:hover .text-truncate{color:#ca0c16}
</style>
<style>
.recommend-box ._4paradigm_box.T3 a .content-box{margin-left:0} .recommend-box ._4paradigm_box.T3 a .content-box h4{vertical-align:top}.recommend-box ._4paradigm_box.p4courset3_target {padding:0}.recommend-box ._4paradigm_box._paradigm_T_ads_render {padding:0} .recommend-box ._4paradigm_box._paradigm_T_ads_render a {width:100%;display:inline-block} ._4paradigm_box._paradigm_T_ads_render a:hover .text-truncate{color:#ca0c16}
</style>
<style>
.recommend-box ._4paradigm_box.T3 a .content-box{margin-left:0} .recommend-box ._4paradigm_box.T3 a .content-box h4{vertical-align:top}.recommend-box ._4paradigm_box.p4courset3_target {padding:0}.recommend-box ._4paradigm_box._paradigm_T_ads_render {padding:0} .recommend-box ._4paradigm_box._paradigm_T_ads_render a {width:100%;display:inline-block} ._4paradigm_box._paradigm_T_ads_render a:hover .text-truncate{color:#ca0c16}
</style>
<style>
pre{position: relative}pre:hover .hljs-button{display: block}.hljs-button{display: none;position: absolute;right: 4px;top: 4px;font-size: 12px;color: #4d4d4d;background-color: white;padding: 2px 8px;margin: 8px;border-radius: 4px;cursor: pointer; box-shadow: 0 2px 4px rgba(0,0,0,0.05), 0 2px 4px rgba(0,0,0,0.05);}.hljs-button:after{content: attr(data-title)}
</style>
<style>
.hljs-ln{border-collapse:collapse}            .hljs-ln td{padding:0}            .hljs-ln-n{text-align: right;padding-right: 8px;}            .hljs-ln-n:before{content:attr(data-line-number)}
</style>
<style>
.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}

</style>
<style>
#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}

</style>
<style>
.MathJax_Preview .MJXf-math {color: inherit!important}

</style>
<style>
.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}

</style>
<style>
#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}

</style>
<style>
.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}

</style>
<style>

</style>
<style>

</style>
<style>

</style>
<style>

</style>
<style>

</style>
<style>

</style>
<style>

</style>
<style>

</style>
<style>

</style>
<style>

</style>
<style>

</style>
<style>
object,embed{                -webkit-animation-duration:.001s;-webkit-animation-name:playerInserted;                -ms-animation-duration:.001s;-ms-animation-name:playerInserted;                -o-animation-duration:.001s;-o-animation-name:playerInserted;                animation-duration:.001s;animation-name:playerInserted;}                @-webkit-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @-ms-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @-o-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}
</style>
<style>
.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}

</style>
<style>
#rwl-iqxin{position:fixed;transform:translate(-90px,0);width:85px;height:25px;font-size:12px;font-weight: 500;font-family:Verdana, Arial, '宋体';color:#fff;background:#333;z-index:2147483647;margin: 0;opacity:0.05;transition:0.3s;overflow:hidden;user-select:none;text-align:center;white-space:nowrap;line-height:25px;padding:0 16px;border:1px solid #ccc;border-width:1px 1px 1px 0;border-bottom-right-radius:5px;box-sizing: content-box;}#rwl-iqxin input{margin: 0;padding: 0;vertical-align:middle;-webkit-appearance:checkbox;-moz-appearance:checkbox;position: static;clip: auto;opacity: 1;cursor: pointer;}#rwl-iqxin.rwl-active-iqxin{left: 0px;transform:translate(0,0);opacity: 0.9;height: 32px;line-height: 32px}#rwl-iqxin label{margin:0;padding:0;font-weight:500;}#rwl-iqxin button{margin: 0;padding: 0 2px;border: none;border-radius: 2px;cursor: pointer;}#rwl-setMenu{text-align:left;font-size:14px;z-index:999999;border: 1px solid cornflowerblue;}#rwl-setMenu p{margin:5px auto;} 
</style>
<style>
.imgViewDom{display:none;position:fixed;top:0;left:0;height:100%;width:100%;z-index:99999999;background: rgba(255, 255, 255,0.8);overflow: auto;display:-webkit-box;-webkit-box-align:center;-webkit-box-pack:center;display:-moz-box;-moz-box-align:center;-moz-box-pack:center;display:-o-box;-o-box-align:center;-o-box-pack:center;display:-ms-box;-ms-box-align:center;-ms-box-pack:center; display:box;box-align:center;box-pack:center;}.imgViewDom img{cursor: zoom-out;}
</style>
<style>
#leftdiv,#rightdiv,#stickey_footer,#top_box,.ershiba,.recommend-box,.floatBottom img,.ad_float_left,body .img,.side-widget,.blog-post  .row .side,.content__tech{display:none!important;}<br>.box.pic_text img,#wp img,#postlist img{max-height: 400px;width: auto;}<br>.post-topheader__info--title{text-align: center;}<br>.blog-post  .row .main,.container.main-container .container,.main-area.article-area{width: 100%;max-width: 100%;}<br><br>#juejin .container{max-width:1140px;}<br><br>.container.main-container .sidebar,.container.main-container .article-suspended-panel,.global-component-box .suspension-panel{display:none!important;}
</style>

    <style class="mx-wc-style">
      .mx-wc-main img {max-width: 100%;}
      .mx-wc-main{
        box-sizing: content-box;
        background-color: rgb(245, 246, 247) !important;
        margin: 0 auto;
        max-width: 1010px;
        padding: 15px 15px 80px 15px;
      }

      .clipping-information{
        text-align: left;
        margin-top: 20px;
        background-color: #eeeeee !important;
        padding: 15px;
        border-radius: 4px;
        color: #333;
        font-size: 14px !important;
        line-height: 22px !important;
      }
      .clipping-information a {
        color: blue !important;
        text-decoration: underline !important;
      }
      .clipping-information label {
        display: inline;
        text-transform: none;
      }
      .clipping-information label > code {
        padding: 2px 8px;
        background-color: rgba(200, 200, 200, 0.7)!important;
        font-size: 14px;
      }

    </style>
  </head>
  <body style="background-color: #464646 !important; min-height: 100%; height: auto;" id="" class="">
    <div class="mx-wc-main">
      <DIV class="container clearfix" id="mainBox" style="display: block; float: none; position: relative; top: 0; left: 0; border: 0px; width: 100%; min-width:100%; max-width: 100%; min-height: auto; max-height: 100%; height: auto; padding: 0px; margin: 0px;"><MAIN style="display: block; float: none; position: relative; top: 0; left: 0; border: 0px; width: 100%; min-width:100%; max-width: 100%; min-height: auto; max-height: 100%; height: auto; padding: 0px; margin: 0px;"><div class="blog-content-box mx-wc-selected-elem" style="float: none; position: relative; top: 0px; left: 0px; margin: 0px; flex: unset; width: 100%; max-width: 100%; box-sizing: border-box;">
	<div class="article-header-box">
		<div class="article-header">
			<div class="article-title-box">
				<span class="article-type type-1 float-left">原</span>				<h1 class="title-article">移动端 / 微信浏览器开发遇到的坑</h1>
			</div>
			<div class="article-info-box">
				<div class="article-bar-top">
																				<span class="time">2018年07月27日 10:38:59</span>
					<a class="follow-nickName" href="https://me.csdn.net/m0_37036014" target="_blank">朱桂彪</a>
						<span class="read-count">阅读数：1676</span>
										</div>
				<div class="operating">
									</div>
			</div>
		</div>
	</div>
	<article class="baidu_pl">
		<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <div id="content_views" class="markdown_views prism-atom-one-dark">
							<!-- flowchart 箭头图标 勿删 -->
							
							<h1><a name="t0"></a><a id="_0" target="_blank"></a>前沿</h1>
<p>17年后开始公司的一个移动端项目（电商网站），框架选用是vue，这篇文章也是在花费1个月的时间，项目一期完成之后总结性文章，其中包括通用的移动端开发的遇到的坑以及vue移动端开发特有的一些坑，本博客旨在后在开发移动端的时候可以尽量避免掉踩过的坑</p>
<ul> 
 <li>移动端开发遇到的问题</li> 
 <li>vue移动开发特有坑以及小技巧分享</li> 
 <li>移动端开发性能优化</li> 
</ul> 
<span id="OSC_h1_2"></span>
<h1><a name="t1"></a><a id="_10" target="_blank"></a>一、移动端开发通用坑</h1>
<h2><a name="t2"></a><a id="1click300ms_11" target="_blank"></a>1、click300ms延迟问题</h2>
<p>讲道理，现在开发移动端基本是不会有这么一个问题的。但作为移动端以前的经典坑，我这里也拿出来说上一说吧。移动设备上的web网页是有300ms延迟的，玩玩会造成按钮点击延迟甚至是点击失效。这是由于区分单击事件和双击屏幕缩放的历史原因造成的。但在2014年的Chrome 32版本已经把这个延迟去掉了，so you know。但如果你还是出现了300ms的延迟问题，也是有路子搞定的。<br>
解决方案如下：</p>
<ul> 
 <li>fastclick可以解决在手机上点击事件的300ms延迟，直接引入即可</li> 
 <li>zepto的touch模块，tap事件也是为了解决在click的延迟问题</li> 
 <li>若移动设备兼容性正常的话（IE/Firefox/Safari(IOS 9.3)及以上），只需加上一个meta标签 
</li></ul><pre class="prettyprint"><code class="prism language-css has-numbering" onclick="mdcp.signin(event)">&lt;meta name=<span class="token string">"viewport"</span> content=<span class="token string">"width=device-width"</span>&gt;
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li></ul></pre>
<p>即把viewport设置成设备的实际像素，那么就不会有这300ms的延</p> 

<h2><a name="t3"></a><a id="2_25" target="_blank"></a>2、移动端样式兼容处理</h2>
<p>当今的手机端，各式各样的手机，屏幕分辨率也是各有不同，为了让页面可以可以兼容各大手机，解决方案如下</p> 
<ul> 
 <li>设置meta标签viewport属性，使其无视设备的真实分辨率，直接通过dpi，在物理尺寸和浏览器之间重设分辨率，从而达到能有统一的分辨率的效果。并且禁止掉用户缩放 
</li></ul><pre class="prettyprint"><code class="prism language-css has-numbering" onclick="mdcp.signin(event)">&lt;meta name=<span class="token string">"viewport"</span> content=<span class="token string">"width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"</span> /&gt;
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li></ul></pre>

<p>使用rem进行屏幕适配，设置好root元素的font-size大小，然后在开发的时候，所有与像素有关的布局统一换成rem单位。针对不同的手机，使用媒体查询对root元素font-size进行调整</p>
 
<h2><a name="t4"></a><a id="3px_37" target="_blank"></a>3、移动端宽高相等的元素（不定具体px）</h2>
<ul>
<li>移动端开发时一般都会遇到需要一个正方形的元素，比如9宫格展示啦，评论图片啦，这时候就需要宽高相等，解决办法如下</li>
</ul>
<pre class="prettyprint"><code class="prism language-css has-numbering" onclick="mdcp.signin(event)"><span class="token selector">// 这里vw就是屏幕的宽度，宽高都是屏幕的百分之30，这样就巧妙的让宽高都一样了
.div</span><span class="token punctuation">{</span>
	<span class="token property">width</span><span class="token punctuation">:</span> 30vw<span class="token punctuation">;</span>
	<span class="token property">height</span><span class="token punctuation">:</span> 30vw<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li></ul></pre>
<h2><a name="t5"></a><a id="4_47" target="_blank"></a>4、阻止旋转屏幕时自动调整字体大小</h2>
<p>移动端开发时，屏幕有竖屏和横屏模式，当屏幕进行旋转时，字体大小则有可能会发生变化，从而影响页面布局的整体样式，为避免此类情况发生，只需设置如下样式即可</p>
<pre class="prettyprint"><code class="prism language-css has-numbering" onclick="mdcp.signin(event)"><span class="token selector">*</span> <span class="token punctuation">{</span>
  <span class="token property">-webkit-text-size-adjust</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li></ul></pre>
<h2><a name="t6"></a><a id="5iOS_54" target="_blank"></a>5、修改移动端难看的点击的高亮效果，iOS和安卓下都有效</h2>
<pre class="prettyprint"><code class="prism language-css has-numbering" onclick="mdcp.signin(event)"><span class="token selector">*</span> <span class="token punctuation">{</span>
  <span class="token property">-webkit-tap-highlight-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>0,0,0,0<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li></ul></pre>
<p>不过这个方法在现在的安卓浏览器下，只能去掉那个橙色的背景色，点击产生的高亮边框还是没有去掉，有待解决！</p>
<h2><a name="t7"></a><a id="6iOSinput_62" target="_blank"></a>6、iOS下取消input在输入的时候英文首字母的默认大写</h2>
<pre class="prettyprint"><code class="prism language-css has-numbering" onclick="mdcp.signin(event)">&lt;input type=<span class="token string">"text"</span> autocapitalize=<span class="token string">"none"</span>&gt;
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li></ul></pre>
<h2><a name="t8"></a><a id="7_iOS__67" target="_blank"></a>7、禁止 iOS 识别长串数字为电话</h2>
<pre class="prettyprint"><code class="prism language-css has-numbering" onclick="mdcp.signin(event)">&lt;meta name=<span class="token string">"format-detection"</span> content=<span class="token string">"telephone=no"</span> /&gt;
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li></ul></pre>
<h2><a name="t9"></a><a id="8_iOS__72" target="_blank"></a>8、禁止 iOS 弹出各种操作窗口</h2>
<pre class="prettyprint"><code class="prism language-css has-numbering" onclick="mdcp.signin(event)"><span class="token property">-webkit-touch-callout</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li></ul></pre>
<h2><a name="t10"></a><a id="9iosandroid_77" target="_blank"></a>9、禁止ios和android用户选中文字</h2>
<pre class="prettyprint"><code class="prism language-css has-numbering" onclick="mdcp.signin(event)"><span class="token property">-webkit-user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li></ul></pre>
<h2><a name="t11"></a><a id="10calc_82" target="_blank"></a>10、calc的兼容处理</h2>
<p>CSS3中的calc变量在iOS6浏览器中必须加-webkit-前缀，目前的FF浏览器已经无需-moz-前缀。 Android浏览器目前仍然不支持calc，所以要在之前增加一个保守尺寸：</p>
<pre class="prettyprint"><code class="prism language-css has-numbering" onclick="mdcp.signin(event)"><span class="token selector">div</span> <span class="token punctuation">{</span> 
  <span class="token property">width</span><span class="token punctuation">:</span> 95%<span class="token punctuation">;</span> 
  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token function">-webkit-calc</span><span class="token punctuation">(</span>100% - 50px<span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span>100% - 50px<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li></ul></pre>
<h2><a name="t12"></a><a id="11fixed_91" target="_blank"></a>11、fixed定位缺陷</h2>
<p>iOS下fixed元素容易定位出错，软键盘弹出时，影响fixed元素定位，android下fixed表现要比iOS更好，软键盘弹出时，不会影响fixed元素定位 。iOS4下不支持position:fixed</p> 
<p>解决方案： 可用iScroll插件解决这个问题</p> 
<h2><a name="t13"></a><a id="12labelspanclickios_95" target="_blank"></a>12、一些情况下对非可点击元素如(label,span)监听click事件，ios下不会触发</h2>
<pre class="prettyprint"><code class="prism language-css has-numbering" onclick="mdcp.signin(event)"><span class="token selector">div</span> <span class="token punctuation">{</span> 
  <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li></ul></pre>
<p>针对此种情况只需要对不触发click事件的那些元素添加一行css代码即可</p>
<h2><a name="t14"></a><a id="13transition_103" target="_blank"></a>13、消除transition闪屏问题</h2>
<pre class="prettyprint"><code class="prism language-css has-numbering" onclick="mdcp.signin(event)"><span class="token comment">/*设置内嵌的元素在 3D 空间如何呈现：保留 3D*/</span>
<span class="token property">-webkit-transform-style</span><span class="token punctuation">:</span> preserve-3d<span class="token punctuation">;</span>
<span class="token comment">/*(设置进行转换的元素的背面在面对用户时是否可见：隐藏)*/</span> 
<span class="token property">-webkit-backface-visibility</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span> 
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li></ul></pre>
<h2><a name="t15"></a><a id="14CSS_110" target="_blank"></a>14、CSS动画页面闪白,动画卡顿</h2>
<p>解决方法:</p> 
1.尽可能地使用合成属性transform和opacity来设计CSS3动画，不使用position的left和top来定位<br> 2.开启硬件加速
<pre class="prettyprint"><code class="prism language-css has-numbering" onclick="mdcp.signin(event)"><span class="token property">-webkit-transform</span><span class="token punctuation">:</span> <span class="token function">translate3d</span><span class="token punctuation">(</span>0, 0, 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token property">-moz-transform</span><span class="token punctuation">:</span> <span class="token function">translate3d</span><span class="token punctuation">(</span>0, 0, 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">-ms-transform</span><span class="token punctuation">:</span> <span class="token function">translate3d</span><span class="token punctuation">(</span>0, 0, 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3d</span><span class="token punctuation">(</span>0, 0, 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li></ul></pre>
<h2><a name="t16"></a><a id="15iOS_122" target="_blank"></a>15、iOS系统中文输入法输入英文时，字母之间可能会出现一个六分之一的空格</h2>
<p>解决方法：通过正则去除</p>
<pre class="prettyprint"><code class="prism language-css has-numbering" onclick="mdcp.signin(event)">this.value = this.value.<span class="token function">replace</span><span class="token punctuation">(</span>/\u2006/g, <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li></ul></pre>
<h2><a name="t17"></a><a id="16inputplaceholder_128" target="_blank"></a>16、input的placeholder会出现文本位置偏上的情况</h2>
<p>input 的placeholder会出现文本位置偏上的情况：PC端设置line-height等于height能够对齐，而移动端仍然是偏上，解决方案时是设置css</p> 
<pre class="prettyprint"><code class="hljs css has-numbering" onclick="mdcp.signin(event)"><span class="hljs-selector-tag">line-height</span>：<span class="hljs-selector-tag">normal</span>;</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li></ul></pre> 
<span id="OSC_h2_18"></span>
<h2><a name="t18"></a><a id="17_133" target="_blank"></a>17、浮动子元素撑开父元素盒子高度</h2>
<p>解决方法如下：</p> 
<ol> 
 <li>父元素设置为&nbsp;overflow:&nbsp;hidden;</li> 
 <li>父元素设置为 display: inline-block; 等</li> 
</ol> 
<p>这里两种方法都是通过设置css属性将浮动元素的父元素变成间接变成BFC元素，然后使得子元素高度可以撑开父元素。这里需要注意的时，最好使用方法1， 因为inline-block元素本身会自带一些宽高度撑开其本身。</p> 
<span id="OSC_h2_19"></span>
<h2><a name="t19"></a><a id="18_142" target="_blank"></a>18、往返缓存问题</h2>
<p>点击浏览器的回退，有时候不会自动执行js，特别是在mobilesafari中。这与往返缓存(bfcache)有关系。 解决方法 ：</p> 
<pre class="prettyprint"><code class="hljs javascript has-numbering" onclick="mdcp.signin(event)"><span class="hljs-built_in">window</span>.onunload = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{};</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li></ul></pre> 
<span id="OSC_h2_20"></span>
<h2><a name="t20"></a><a id="19css_147" target="_blank"></a>19、css滚动优化</h2>
<p>解决方法：</p> 
<pre class="prettyprint"><code class="hljs css has-numbering" onclick="mdcp.signin(event)"><span class="hljs-selector-tag">-webkit-overflow-scrolling</span>: <span class="hljs-selector-tag">touch</span>;</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li></ul></pre> 
<span id="OSC_h2_21"></span>
<h2><a name="t21"></a><a id="20_152" target="_blank"></a>20、点击穿透</h2>
<p>一个CSS3的属性，加上后，所关联的元素的事件监听都会失效，等于让元素变得“看得见，点不着”。IE到11才开始支持，其他浏览器的当前版本基本都支持。详细介绍见这里：<a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/pointer-events" rel="nofollow" target="_blank">https://developer.mozilla.org/zh-CN/docs/Web/CSS/pointer-events</a></p> 
<pre class="prettyprint"><code class="hljs css has-numbering" onclick="mdcp.signin(event)"><span class="hljs-selector-tag">pointer-events</span>: <span class="hljs-selector-tag">none</span>;</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li></ul></pre> 
<h1 id="h1_22"><a name="t22"></a>二、vue移动开发特有坑以及小技巧分享</h1> 
<h2><a name="t23"></a><a id="1iOS_158" target="_blank"></a>1、iOS原始输入法问题</h2>
<p>iOS原始输入法，中文输入时，无法触发keyup事件，且keyup.enter事件无论中英文，都无法触发</p> 
<p>解决方法：</p> 
<ol> 
 <li>改用input事件进行监听</li> 
 <li>将keyup监听替换成值的watch</li> 
 <li>让使用者安装三方输入法，比如搜狗输入法（不太现实）</li> 
</ol> 
<h2><a name="t24"></a><a id="2input_167" target="_blank"></a>2、input元素失焦问题</h2>
<p>业务场景重现： 项目中需要写一个搜索组件，相关代码如下</p>
<pre class="prettyprint"><code class="prism language-js has-numbering" onclick="mdcp.signin(event)"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"y-search"</span> <span class="token punctuation">:</span>style<span class="token operator">=</span><span class="token string">"styles"</span> <span class="token punctuation">:</span>clear<span class="token operator">=</span><span class="token string">"clear"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string">"#"</span> onsubmit<span class="token operator">=</span><span class="token string">"return false;"</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"search"</span>
        <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"y-search-input"</span>
        ref<span class="token operator">=</span><span class="token string">"search"</span>
        v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">'model'</span>
        <span class="token punctuation">:</span>placeholder<span class="token operator">=</span><span class="token string">"placeholder"</span>
        @input<span class="token operator">=</span><span class="token string">"searchInputFn"</span>
        @keyup<span class="token punctuation">.</span>enter<span class="token operator">=</span><span class="token string">"searchEnterFn"</span>
        @foucs<span class="token operator">=</span><span class="token string">"searchFocusFn"</span>
        @blur<span class="token operator">=</span><span class="token string">"searchBlurFn"</span>
      <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>y<span class="token operator">-</span>icons <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"search-icon"</span> name<span class="token operator">=</span><span class="token string">"search"</span> size<span class="token operator">=</span><span class="token string">"14"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>y<span class="token operator">-</span>icons<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"showClose"</span> @click<span class="token operator">=</span><span class="token string">"closeFn"</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>y<span class="token operator">-</span>icons <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"close-icon"</span> name<span class="token operator">=</span><span class="token string">'close'</span> size<span class="token operator">=</span><span class="token string">'12'</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>y<span class="token operator">-</span>icons<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li><li style="color: rgb(153, 153, 153);">18</li><li style="color: rgb(153, 153, 153);">19</li><li style="color: rgb(153, 153, 153);">20</li></ul></pre>
<p>其中我需要在enter的时候进行对应的搜索操作并实现失焦，解决方法其实很简单，在enter时进行DOM操作即可</p>
<pre class="prettyprint"><code class="prism language-js has-numbering" onclick="mdcp.signin(event)"><span class="token function">searchEnterFn</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">'y-search-input'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">blur</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// dosomething yourself</span>
<span class="token punctuation">}</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li></ul></pre>
<p><strong>对了，这里还有一个坑，就是在移动端使用input类型为search的时候，必须使用form标签包裹起来，这样在移动端呼出键盘的enter才会是搜索按钮，否则只是默认的enter按钮。</strong></p>
<h2><a name="t25"></a><a id="4flex_200" target="_blank"></a>4、巧用flex布局让图片等比缩放</h2>
<p>这也是一个小技巧！项目中需要开发swiper轮播图，那么你懂的，图片肯定是需要保证等比缩放展示。</p>
<pre class="prettyprint"><code class="prism language-js has-numbering" onclick="mdcp.signin(event)"><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"parent"</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>img <span class="token punctuation">:</span>src<span class="token operator">=</span><span class="token string">"imgSrc"</span> alt<span class="token operator">=</span><span class="token string">""</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">"stylus"</span> scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>parent <span class="token punctuation">{</span>
  width<span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>
  height<span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>
  display<span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  align<span class="token operator">-</span>items<span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  
  img <span class="token punctuation">{</span>
    width <span class="token punctuation">:</span><span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
    height<span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li></ul></pre>
<p>是不是贼简单，是的，贼简单这个样式同时适应手机全屏预览竖屏的情况，当手机横屏的时候，加一个媒体查询即可搞定</p>
<pre class="prettyprint"><code class="prism language-css has-numbering" onclick="mdcp.signin(event)"><span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">orientation</span><span class="token punctuation">:</span> landscape<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token selector">img</span> <span class="token punctuation">{</span>
    width auto
    height 100%
    margin auto
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li></ul></pre>
<p>这里我就不上轮播图的代码了，有点小多。有需要的小伙伴可以私聊我，我后期直接传到github上去，代码可以自行查阅。</p> 
<h2><a name="t26"></a><a id="5_235" target="_blank"></a>5、枚举值过滤处理</h2>
<p>业务重现：考虑到项目后期会做国际化，前端需要对项目中几乎所有的枚举值进行过滤处理，从而进行展示</p> 
接下来就直接讲讲这块吧。既然要过滤，那么首选肯定是vue提供的filter指令。这里我举一个支付方式的枚举值处理的例子。首先配置代码如下
<pre class="prettyprint"><code class="prism language-js has-numbering" onclick="mdcp.signin(event)"><span class="token comment">// 配置文件</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  env<span class="token punctuation">:</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'development'</span> <span class="token operator">?</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./env/dev'</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./env/pro'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  headShow<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  lng<span class="token punctuation">:</span> <span class="token string">'zh'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li></ul></pre>
<p>枚举代码如下</p>
<pre class="prettyprint"><code class="prism language-js has-numbering" onclick="mdcp.signin(event)"><span class="token comment">// 获取语言环境</span>
<span class="token keyword">import</span> config <span class="token keyword">from</span> <span class="token string">'../config/index'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span>lng<span class="token punctuation">}</span> <span class="token operator">=</span> config<span class="token punctuation">;</span>
<span class="token comment">// 账户类型</span>
<span class="token keyword">const</span> type <span class="token operator">=</span> <span class="token punctuation">{</span>
  zh<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">'银行'</span><span class="token punctuation">,</span>
    <span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">'支付宝'</span><span class="token punctuation">,</span>
    <span class="token number">3</span><span class="token punctuation">:</span> <span class="token string">'微信支付'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  en<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">'bank_type'</span><span class="token punctuation">,</span>
    <span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">'alipay_type'</span><span class="token punctuation">,</span>
    <span class="token number">3</span><span class="token punctuation">:</span> <span class="token string">'wxpay_type'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> type<span class="token punctuation">[</span>lng<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li><li style="color: rgb(153, 153, 153);">18</li></ul></pre>
<p>枚举注册代码分别如下</p>
<pre class="prettyprint"><code class="prism language-js has-numbering" onclick="mdcp.signin(event)"><span class="token keyword">import</span> accountType <span class="token keyword">from</span> <span class="token string">'./accountType'</span><span class="token punctuation">;</span> <span class="token comment">// 账户类型</span>

<span class="token keyword">const</span> factory <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">accountType</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">'请选择账户类型'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> accountType<span class="token punctuation">[</span>value<span class="token punctuation">]</span> <span class="token operator">?</span> accountType<span class="token punctuation">[</span>value<span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token string">'请选择账户类型'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> filter <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'formatEnum'</span><span class="token punctuation">,</span> <span class="token comment">// 过滤类型</span>
    filter<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> type<span class="token punctuation">,</span> status<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> factory<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> status<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  filter
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li><li style="color: rgb(153, 153, 153);">18</li><li style="color: rgb(153, 153, 153);">19</li><li style="color: rgb(153, 153, 153);">20</li><li style="color: rgb(153, 153, 153);">21</li></ul></pre>
<pre class="prettyprint"><code class="prism language-js has-numbering" onclick="mdcp.signin(event)"><span class="token comment">// filter</span>
<span class="token keyword">import</span> baseFilter <span class="token keyword">from</span> <span class="token string">'./filter/index'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> filters <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token operator">...</span>baseFilter<span class="token punctuation">.</span>filter
<span class="token punctuation">]</span><span class="token punctuation">;</span>
filters<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>f <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  Vue<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>name<span class="token punctuation">,</span> f<span class="token punctuation">.</span>filter<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li></ul></pre>
<p>接下来就可以轻松使用啦</p>
<pre class="prettyprint"><code class="prism language-js has-numbering" onclick="mdcp.signin(event)"><span class="token operator">&lt;</span>li<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>label支付类型<span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span>info<span class="token punctuation">.</span>account_type <span class="token operator">|</span> <span class="token function">formatEnum</span><span class="token punctuation">(</span><span class="token string">'accountType'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li></ul></pre>
<h2><a name="t27"></a><a id="6_318" target="_blank"></a>6、时间过滤处理</h2>
<p>这点还是属于过滤处理的一个part，但是手机端有个兼容问题，如果是时间戳转的话，那么可以转化成任意我们想要的形式，但是String类型的时间转化的话，他只能兼容<strong> "yyyy/MM/dd"&nbsp;</strong>形式的时间值，因为我们DateTime组件默认的形式是<strong>"yyyy-MM-dd"</strong>，那么只需要在DateTime组件正则替换一下即可，代码如下</p> 
<pre class="prettyprint"><code class="hljs javascript has-numbering" onclick="mdcp.signin(event)">currentValue = _this.currentValue = _this.value ? _this.value.replace(<span class="hljs-regexp">/-/g</span>, <span class="hljs-string">'/'</span>) : <span class="hljs-string">''</span>;</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li></ul></pre> 
时间过滤代码如下
<pre class="prettyprint"><code class="prism language-js has-numbering" onclick="mdcp.signin(event)"><span class="token keyword">const</span> filter <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'formatEnum'</span><span class="token punctuation">,</span> <span class="token comment">// 过滤类型</span>
    filter<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> type<span class="token punctuation">,</span> status<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> factory<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> status<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'formatDate'</span><span class="token punctuation">,</span> <span class="token comment">// 日期</span>
    filter<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> format <span class="token operator">=</span> <span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>value <span class="token operator">||</span> value <span class="token operator">===</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> v <span class="token operator">=</span> value<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isNaN</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        v <span class="token operator">=</span> <span class="token operator">+</span>value <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">const</span> newDate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> newDate<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span>format<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li><li style="color: rgb(153, 153, 153);">18</li><li style="color: rgb(153, 153, 153);">19</li><li style="color: rgb(153, 153, 153);">20</li></ul></pre>
<h2><a name="t28"></a><a id="7_347" target="_blank"></a>7、路由权限判定</h2>
<p>业务重现：由于不同的用户，可能拥有不同权限，而目前我们的项目是基于微信公众号进行开发的，页面权限这边也是交给了我们前端处理。既然要前端配置权限，那么我们能想到的比较好的方式就是通过配置路由文件，完成权限判定。下面我会列举一小部分代码(以我们的工单列表)进行演示，路由配置代码如下</p>
<pre class="prettyprint"><code class="prism language-js has-numbering" onclick="mdcp.signin(event)"><span class="token keyword">const</span> <span class="token function-variable function">getWorkOrder</span> <span class="token operator">=</span> pageName <span class="token operator">=&gt;</span> resolve <span class="token operator">=&gt;</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'../pages/WorkOrder'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pages <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span>pages<span class="token punctuation">[</span>pageName<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> routers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
routers <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    path<span class="token punctuation">:</span> <span class="token string">'/workorder'</span><span class="token punctuation">,</span>
    name<span class="token punctuation">:</span> <span class="token string">'workorder'</span><span class="token punctuation">,</span>
    component<span class="token punctuation">:</span> room<span class="token punctuation">,</span>
    children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        path<span class="token punctuation">:</span> <span class="token string">'list'</span><span class="token punctuation">,</span> <span class="token comment">// 管家端工单列表</span>
        name<span class="token punctuation">:</span> <span class="token string">'list'</span><span class="token punctuation">,</span>
        rule<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
        component<span class="token punctuation">:</span> <span class="token function">getWorkOrder</span><span class="token punctuation">(</span><span class="token string">'WorkOrderList'</span><span class="token punctuation">)</span> <span class="token comment">//WorkOrder,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        path<span class="token punctuation">:</span> <span class="token string">'managerList'</span><span class="token punctuation">,</span> <span class="token comment">// 店长端工单列表</span>
        name<span class="token punctuation">:</span> <span class="token string">'managerList'</span><span class="token punctuation">,</span>
        rule<span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
        component<span class="token punctuation">:</span> <span class="token function">getWorkOrder</span><span class="token punctuation">(</span><span class="token string">'ManagerWorkOrder'</span><span class="token punctuation">)</span> <span class="token comment">// WorkOrder,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li><li style="color: rgb(153, 153, 153);">18</li><li style="color: rgb(153, 153, 153);">19</li><li style="color: rgb(153, 153, 153);">20</li><li style="color: rgb(153, 153, 153);">21</li><li style="color: rgb(153, 153, 153);">22</li><li style="color: rgb(153, 153, 153);">23</li><li style="color: rgb(153, 153, 153);">24</li></ul></pre>
<p>然后进行路由统一过滤处理</p>
<pre class="prettyprint"><code class="prism language-js has-numbering" onclick="mdcp.signin(event)"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Store <span class="token keyword">from</span> <span class="token string">'store'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Router <span class="token keyword">from</span> <span class="token string">'vue-router'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> routers <span class="token keyword">from</span> <span class="token string">'./router.config'</span><span class="token punctuation">;</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Router<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 遍历路由名称以及权限</span>
<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">routeName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>router<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>router<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  router<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    arr<span class="token punctuation">[</span>v<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">.</span>rule<span class="token punctuation">;</span>
    <span class="token function">routeName</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">routeName</span><span class="token punctuation">(</span>routers<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> RouterModel <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  mode<span class="token punctuation">:</span> <span class="token string">'history'</span><span class="token punctuation">,</span>
  routes<span class="token punctuation">:</span> routers<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 路由钩子，进入路由之前判断</span>
RouterModel<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 处理query 参数，传入到 jumpUrl，便于登录后跳转到对应页面</span>
  <span class="token keyword">let</span> qu <span class="token operator">=</span>  Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>to<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>qu<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    qu <span class="token operator">=</span> qu<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> item<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>to<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果有权限需要</span>
    <span class="token keyword">const</span> userInfo <span class="token operator">=</span> Store<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'yu_info'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> cookie <span class="token operator">=</span> Vue<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$util<span class="token punctuation">.</span><span class="token function">getCookie</span><span class="token punctuation">(</span><span class="token string">'X-Auth-Token'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> userId <span class="token operator">=</span> Vue<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$util<span class="token punctuation">.</span><span class="token function">getCookie</span><span class="token punctuation">(</span><span class="token string">'userid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>userInfo <span class="token operator">&amp;&amp;</span> cookie <span class="token operator">&amp;&amp;</span> <span class="token operator">+</span>userId <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// 未登录，跳转登录</span>
      <span class="token keyword">let</span> param <span class="token operator">=</span> <span class="token template-string"><span class="token string">`jumpUrl=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>to<span class="token punctuation">.</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>qu<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        param <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`&amp;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>qu<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">"&amp;"</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>to<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>to<span class="token punctuation">.</span>query<span class="token punctuation">.</span>rule<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        param <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`&amp;rule=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>arr<span class="token punctuation">[</span>to<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token template-string"><span class="token string">`/login?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>param<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果不需要权限放行</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> RouterModel<span class="token punctuation">;</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li><li style="color: rgb(153, 153, 153);">18</li><li style="color: rgb(153, 153, 153);">19</li><li style="color: rgb(153, 153, 153);">20</li><li style="color: rgb(153, 153, 153);">21</li><li style="color: rgb(153, 153, 153);">22</li><li style="color: rgb(153, 153, 153);">23</li><li style="color: rgb(153, 153, 153);">24</li><li style="color: rgb(153, 153, 153);">25</li><li style="color: rgb(153, 153, 153);">26</li><li style="color: rgb(153, 153, 153);">27</li><li style="color: rgb(153, 153, 153);">28</li><li style="color: rgb(153, 153, 153);">29</li><li style="color: rgb(153, 153, 153);">30</li><li style="color: rgb(153, 153, 153);">31</li><li style="color: rgb(153, 153, 153);">32</li><li style="color: rgb(153, 153, 153);">33</li><li style="color: rgb(153, 153, 153);">34</li><li style="color: rgb(153, 153, 153);">35</li><li style="color: rgb(153, 153, 153);">36</li><li style="color: rgb(153, 153, 153);">37</li><li style="color: rgb(153, 153, 153);">38</li><li style="color: rgb(153, 153, 153);">39</li><li style="color: rgb(153, 153, 153);">40</li><li style="color: rgb(153, 153, 153);">41</li><li style="color: rgb(153, 153, 153);">42</li><li style="color: rgb(153, 153, 153);">43</li><li style="color: rgb(153, 153, 153);">44</li><li style="color: rgb(153, 153, 153);">45</li><li style="color: rgb(153, 153, 153);">46</li><li style="color: rgb(153, 153, 153);">47</li><li style="color: rgb(153, 153, 153);">48</li><li style="color: rgb(153, 153, 153);">49</li><li style="color: rgb(153, 153, 153);">50</li><li style="color: rgb(153, 153, 153);">51</li><li style="color: rgb(153, 153, 153);">52</li><li style="color: rgb(153, 153, 153);">53</li><li style="color: rgb(153, 153, 153);">54</li><li style="color: rgb(153, 153, 153);">55</li><li style="color: rgb(153, 153, 153);">56</li><li style="color: rgb(153, 153, 153);">57</li></ul></pre>
<p>然后在登陆界面定位到微信授权</p>
<pre class="prettyprint"><code class="prism language-js has-numbering" onclick="mdcp.signin(event)"><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 定位到微信授权，若是不需要授权可以在此处处理</span>
  <span class="token keyword">let</span> query <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>query<span class="token punctuation">;</span>
  <span class="token keyword">let</span> param <span class="token operator">=</span> <span class="token template-string"><span class="token string">`jumpUrl=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>query<span class="token punctuation">.</span>jumpUrl <span class="token operator">||</span> <span class="token string">'/home'</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> path <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>origin<span class="token punctuation">;</span>
  <span class="token comment">// 登录角色处理</span>
  <span class="token keyword">let</span> cfg <span class="token operator">=</span> api<span class="token punctuation">[</span>query<span class="token punctuation">.</span>rule <span class="token operator">?</span> query<span class="token punctuation">.</span>rule <span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span>rule<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    param <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`&amp;rule=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>query<span class="token punctuation">.</span>rule<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">let</span> redirect_url <span class="token operator">=</span> <span class="token function">encodeURIComponent</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/login?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>param<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> url <span class="token operator">=</span>  <span class="token template-string"><span class="token string">`https://open.weixin.qq.com/connect/oauth2/authorize?appid=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>cfg<span class="token punctuation">.</span>tempApp<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;redirect_uri=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>redirect_url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;response_type=code&amp;scope=snsapi_userinfo&amp;state=1#wechat_redirect`</span></span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span>rule <span class="token operator">===</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    url <span class="token operator">+=</span> <span class="token string">'&amp;agentid=1000004'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  location<span class="token punctuation">.</span>replace <span class="token operator">=</span> url<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li><li style="color: rgb(153, 153, 153);">18</li></ul></pre>
<p>如果不是微信端，访问到到rule规则的界面时，则会如下<br> <img height="723" src="assets/1553637380-797c4e5dfaaee62f253b2548a6017f19.png" width="438"></p> 
<p>&nbsp;</p> 
而当微信授权通过的时候，rule权限不足的情况则会如下<br> <img height="689" src="assets/1553637380-3cb4f9cbd84d607e0b849fd2da6fa84f.png" width="402">
<h2><a name="t29"></a><a id="8vuecli_proxyTable_462" target="_blank"></a>8、使用vue-cli proxyTable进行反向代理，解决跨域问题</h2>
<p>开发项目，在前后端联调的时候肯定是会遇上跨域的问题的。很简单，做个反向代理呗，对于想了解正向代理和反向代理的，<a href="https://www.zhihu.com/question/24723688" rel="nofollow" target="_blank">请点击这里</a></p> 
<p>vue-cli脚手架搭建的工程中，在config/index.js文件中可以利用预留的proxyTable一项，设置地址映射表，如下</p> 
<pre class="prettyprint"><code class="prism language-js has-numbering" onclick="mdcp.signin(event)">proxyTable<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token string">'/api'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    target<span class="token punctuation">:</span> <span class="token string">'http://www.example.com'</span><span class="token punctuation">,</span> <span class="token comment">// your target host</span>
    changeOrigin<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// needed for virtual hosted sites</span>
    pathRewrite<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">'^/api'</span><span class="token punctuation">:</span> <span class="token string">''</span>  <span class="token comment">// rewrite path</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li></ul></pre>
<p>然后使用<strong>http-proxy-middleware</strong>插件对api请求地址进行代理</p> 
<pre class="prettyprint"><code class="prism language-js has-numbering" onclick="mdcp.signin(event)"><span class="token comment">// proxy api requests</span>
Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>proxyTable<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> options <span class="token operator">=</span> proxyTable<span class="token punctuation">[</span>context<span class="token punctuation">]</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> options <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    options <span class="token operator">=</span> <span class="token punctuation">{</span> target<span class="token punctuation">:</span> options <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">proxyMiddleware</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>filter <span class="token operator">||</span> context<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li></ul></pre>
<p><a href="https://github.com/chimurai/http-proxy-middleware" rel="nofollow" target="_blank">http-proxy-middleware地址</a></p>
<h1 id="h1_32"><a name="t30"></a>三、移动端开发性能优化</h1> 
<p><img height="800" src="assets/1553637380-37699b70b1f9c54218976acfb6c6a0f6.png" width="566"></p> 
<p>对于这点，有一篇文章建议大家可以先看看<a href="https://segmentfault.com/a/1190000002511921" rel="nofollow" target="_blank">《移动前端H5性能优化指南》</a>。接下来我会结合实际项目抽几个点配合代码进行较为详细的讲解。</p> 
<span id="OSC_h2_33"></span>
## 1、首屏渲染优化
<p>决定用户体验最重要的一个点之一，这个点的重要性，相信不用我说了。下面直接谈实战。</p> 
<ul> 
 <li> <p>减少资源请求次数</p> </li> 
 <li> <p>加载时使用过渡样式，防止用户网络太差影响对首页的体验</p> </li> 
 <li> <p>图片使用懒加载，这一part，我们目前项目中使用的vue的三方插件<a href="https://github.com/hilongjw/vue-lazyload" rel="nofollow" target="_blank">vue-lazyload</a>，大致使用方法如下</p> <pre class="prettyprint"><code class="hljs javascript has-numbering" onclick="mdcp.signin(event)"><span class="hljs-comment">// 全局注册</span>
<span class="hljs-keyword">import</span> VueLazyload <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-lazyload'</span>;
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li></ul></pre></li></ul><p>Vue.use(VueLazyload, {<br>
<span class="hljs-attr">error</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">’./assets/close.svg’</span>),<br>
<span class="hljs-attr">loading</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">’./assets/loading.svg’</span>),<br>
<span class="hljs-attr">attempt</span>: <span class="hljs-number">1</span>,<br>
});</p>
<p><span class="hljs-comment">// 使用</span><br>
&lt;img v-lazy=<span class="hljs-string">“room.img”</span> :alt=<span class="hljs-string">“room.community_name”</span> width=<span class="hljs-string">“100%”</span>&gt; </p><p>&nbsp;</p> 
 <li> <p>HTML使用Viewport，Viewport可以加速页面的渲染。</p> <pre class="prettyprint"><code class="hljs html xml has-numbering" onclick="mdcp.signin(event)"><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">”viewport”</span> <span class="hljs-attr">content</span>=<span class="hljs-string">”width</span>=<span class="hljs-string">device-width,</span> <span class="hljs-attr">initial-scale</span>=<span class="hljs-string">1″</span>&gt;</span></code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li></ul></pre> <p>除此之外，还有很多点可做优化，进而提升首屏加载速度。</p> </li> 
 
<h2><a name="t31"></a><a id="2_516" target="_blank"></a>2、雪碧图</h2>
<p>这个就很普遍了，为了减少图片请求次数，加快页面加载，当然会考虑使用雪碧图。来个小例子，一天，设计小姐姐给了我一张icon表，<br>
<img src="assets/1553637380-cfabe146bf330e2c9290217db6ca531f.png" alt="雪碧图"></p>
<p>每张icon都有1k大小。好嘛，只能自己在线合张雪碧图，合完雪碧图顺带在线压缩优化下，然后总大小只有1  2K。还有一个点，就是尽量使用::before或::after伪类，Sprites中的图片排版可以更紧 ，图片体积更小， HTML更简洁。部分代码如下</p> 
<pre class="prettyprint"><code class="prism language-css has-numbering" onclick="mdcp.signin(event)"><span class="token selector">&lt;style lang="stylus" scoped&gt;
  .chose-house</span> <span class="token punctuation">{</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 20px<span class="token selector">;
    margin 0 auto
    position relative
    &amp;::before</span> <span class="token punctuation">{</span>
      <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">'\20'</span><span class="token punctuation">;</span>
      <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
      <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
      <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
      <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
      <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
      <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url">url('../../assets/sprite-min.png')</span> 0px 0px no-repeat<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
&lt;/style&gt;
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li></ul></pre>
<h2><a name="t32"></a><a id="3_541" target="_blank"></a>3、路由懒加载</h2>
<p>关于<strong>路由懒加载</strong>这一部分，尤大在vue-router文档中也有所提及，<a href="https://router.vuejs.org/zh-cn/advanced/lazy-loading.html" rel="nofollow" target="_blank">链接点击这里</a>。</p> 
<p>其实在vue项目中使用路由懒加载非常简单，我们要做的就是把路由对应的组件定义成异步组件，代码如下</p> 
<pre class="prettyprint"><code class="prism language-js has-numbering" onclick="mdcp.signin(event)"><span class="token comment">//在router/index.js中引入组件时可使用如下异步方式引入</span>
<span class="token keyword">const</span> <span class="token function-variable function">Foo</span> <span class="token operator">=</span> resolve <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// require.ensure 是 Webpack 的特殊语法，用来设置 code-split point</span>
  <span class="token comment">// （代码分块）</span>
  require<span class="token punctuation">.</span><span class="token function">ensure</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'./Foo.vue'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./Foo.vue'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// or</span>
<span class="token keyword">const</span> <span class="token function-variable function">Foo</span> <span class="token operator">=</span> resolve <span class="token operator">=&gt;</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'./Foo.vue'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> resolve<span class="token punctuation">)</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li></ul></pre>
<p>再将组件按组分块，如</p> 
<pre class="prettyprint"><code class="prism language-js has-numbering" onclick="mdcp.signin(event)"><span class="token keyword">const</span> <span class="token function-variable function">Foo</span> <span class="token operator">=</span> r <span class="token operator">=&gt;</span> require<span class="token punctuation">.</span><span class="token function">ensure</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">r</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./Foo.vue'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'group-foo'</span><span class="token punctuation">)</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li></ul></pre>
<p>实际项目中的代码则如同我在章节<strong>《路由权限判定》</strong>提及到的一样</p> 
<pre class="prettyprint"><code class="prism language-js has-numbering" onclick="mdcp.signin(event)"><span class="token keyword">const</span> <span class="token function-variable function">getWorkOrder</span> <span class="token operator">=</span> pageName <span class="token operator">=&gt;</span> resolve <span class="token operator">=&gt;</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'../pages/WorkOrder'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pages <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span>pages<span class="token punctuation">[</span>pageName<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> routers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
routers <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    path<span class="token punctuation">:</span> <span class="token string">'/workorder'</span><span class="token punctuation">,</span>
    name<span class="token punctuation">:</span> <span class="token string">'workorder'</span><span class="token punctuation">,</span>
    component<span class="token punctuation">:</span> room<span class="token punctuation">,</span>
    children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        path<span class="token punctuation">:</span> <span class="token string">'list'</span><span class="token punctuation">,</span> <span class="token comment">// 管家端工单列表</span>
        name<span class="token punctuation">:</span> <span class="token string">'list'</span><span class="token punctuation">,</span>
        rule<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
        component<span class="token punctuation">:</span> <span class="token function">getWorkOrder</span><span class="token punctuation">(</span><span class="token string">'WorkOrderList'</span><span class="token punctuation">)</span> <span class="token comment">//WorkOrder,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        path<span class="token punctuation">:</span> <span class="token string">'managerList'</span><span class="token punctuation">,</span> <span class="token comment">// 店长端工单列表</span>
        name<span class="token punctuation">:</span> <span class="token string">'managerList'</span><span class="token punctuation">,</span>
        rule<span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
        component<span class="token punctuation">:</span> <span class="token function">getWorkOrder</span><span class="token punctuation">(</span><span class="token string">'ManagerWorkOrder'</span><span class="token punctuation">)</span> <span class="token comment">// WorkOrder,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li><li style="color: rgb(153, 153, 153);">18</li><li style="color: rgb(153, 153, 153);">19</li><li style="color: rgb(153, 153, 153);">20</li><li style="color: rgb(153, 153, 153);">21</li><li style="color: rgb(153, 153, 153);">22</li><li style="color: rgb(153, 153, 153);">23</li><li style="color: rgb(153, 153, 153);">24</li></ul></pre>
<p>如上将组件通过传递pageName参数分别打包到了各个chunk中，这样每个组件加载时都只会加载自己对应的代码，从而加快渲染速度！</p> 
<h2><a name="t33"></a><a id="4_594" target="_blank"></a>4、全局组件按需注册</h2>
<p>当时我们为了优化首屏渲染速度，也是考虑到这一点，项目的<strong>src/main.js</strong>文件主要负责注册全局组件，插件，路由，以及实例化Vue等。在webpack的配置里面也是当成entry入口进行了配置，如果我在main.js里面讲每个组件都进行import的话，那么它将会全部一起注册打包，页面加载也会将每个组件文件都加载下来，这样对渲染速度还是有一定影响的。</p> 
<p>解决方法就是：按需注册，这样在打包的时候，会按需加载首页（其他界面也同样适用）使用到的全局组件。基本步骤如下：</p> 
<p>将需要注册的组件写进components/base.js文件中，然后exports出来</p> 
<pre class="prettyprint"><code class="prism language-js has-numbering" onclick="mdcp.signin(event)">exports<span class="token punctuation">.</span>Foo <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./Foo.vue'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>Bar <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./Bar.vue'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>Baz <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./Baz.vue'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li></ul></pre>
<p>在main.js中进行注册</p>
<pre class="prettyprint"><code class="prism language-js has-numbering" onclick="mdcp.signin(event)"><span class="token keyword">const</span> components <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./components/base'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Foo<span class="token punctuation">,</span>
  <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./components/base'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Bar<span class="token punctuation">,</span>
  <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./components/base'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Baz<span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

components<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>component <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>component<span class="token punctuation">.</span>name<span class="token punctuation">,</span> component<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li></ul></pre>

            </div>
						
                </div>
	</article>
</div></MAIN></DIV>
      
        <hr />
        <!-- clipping information -->
        <div class="clipping-information">
          <label>原网址: <a href="https://blog.csdn.net/m0_37036014/article/details/81232648" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">访问</a></label><br />
          <label>创建于: 2019-03-27 05:56:20</label><br />
          <label>目录: default</label><br />
          <label>标签: 无</label>
        </div>
    </div>
  </body>
</html>